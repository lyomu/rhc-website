<%- include("../_partials/_adminheader.ejs") %>

<!-- [ breadcrumb ] start -->

<div class="page-header">
  <div class="page-block">
    <div class="row align-items-center">
      <div class="col-md-12">
        <div class="page-header-title">
          <h5 class="m-b-10">Blogs</h5>
        </div>
        <ul class="breadcrumb">
          <li class="breadcrumb-item">
            <a href="/"><i class="feather icon-home"></i></a>
          </li>
          <li class="breadcrumb-item">
            <a href="javascript:">Blogs</a>
          </li>
          <li class="breadcrumb-item">
            <a href="javascript:">View</a>
          </li>
          <li class="breadcrumb-item">
            <a href="javascript:"><%= blog.blog_title.toLowerCase() %></a>
          </li>
        </ul>
      </div>
    </div>
  </div>
</div>
<!-- [ breadcrumb ] end -->
<div class="main-body">
  <div class="page-wrapper">
    <div class="d-md-flex">
      <a href="/admin/blogs" class="btn btn-light" style="width: 200px">
        <i class="feather icon-chevron-left"></i> All Blogs</a
      >
      <a
        href="/admin/blogs/edit/<%= blog.id %>"
        class="btn btn-primary"
        style="width: 200px"
      >
        Modify Blog</a
      >
      <form
        action="/admin/blogs/delete/<%= blog.id %>?_method=DELETE"
        onsubmit="return confirm('Do you really want to delete this blog post');"
        method="post"
        class="d-inline"
      >
        <button type="submit" class="btn btn-danger" style="width: 200px">
          Delete
        </button>
      </form>
    </div>

    <div class="card">
      <div class="card-header">
        <h5 style="font-size: 32px; font-weight: bold">
          <%= blog.blog_title %>
        </h5>
        <div class="mt-3">
          <div class="row">
            <div class="col-sm-12 col-md-1">
              <img
                style="
                  vertical-align: middle;
                  width: 50px;
                  height: 50px;
                  border-radius: 50%;
                "
                src="/uploads/images/<%= blog.Writer.writer_image %>"
                alt="Writer image"
              />
            </div>
            <div class="col-sm-12 col-md-11">
              <p class="d-inline text-small">
                <span class="text-bold" style="text-decoration: underline"
                  ><a href="/admin/writers/edit/<%= blog.Writer.id %>"
                    ><%= blog.Writer.writer_fullname %></a
                  ></span
                >
                <%-blog.Writer.writer_description %>
              </p>
            </div>
          </div>
        </div>
      </div>
      <div class="card-body">
        <div class="d-inline-block">
          <p style="font-size: 28" class="my-0">
            Posted on: <span class="text-muted"><%=blog.createdAt %></span>
          </p>
          <p style="font-size: 28" class="my-0">
            Category:
            <span class="text-muted" style="color: red"
              ><%=blog.Blogcategory?.category_name %></span
            >
          </p>
        </div>
        <img
          src="/uploads/images/<%= blog.blog_image %>"
          class="mt-3"
          style="width: 100%; height: 450px"
          alt="blog image"
        />
        <div
          style="
            font-family: 'Gill Sans', 'Gill Sans MT', Calibri, 'Trebuchet MS',
              sans-serif;
          "
          class="mt-2"
        >
          <%- blog.blog_content %>
        </div>
      </div>
    </div>

    <div class="card">
      <div class="card-header">
        <h5 style="font-size: 32px; font-weight: bold">Comments</h5>
      </div>
      <div class="card-body">
        <ul class="media-list">
          <% blog.Blogcomments.sort((a,b)=>{return
          a.createdAt-b.createdAt}).forEach(comment => { %>
          <li class="media">
            <a class="pull-left" href="#fakelink">
              <img class="media-object"
              src="https://eu.ui-avatars.com/api/?name=<%=
              comment.comment_fullname.split(" ")[0] %>+<%=
              comment.comment_fullname.split(" ")[1] %>&size=100" alt="Avatar"
              />
            </a>
            <div class="media-body mx-2">
              <h4 class="media-heading">
                <h6><%= comment.comment_fullname %></h6>
                <small><%= comment.createdAt.toLocaleDateString() %></small>
              </h4>
              <p><%= comment.comment_content %>t</p>
            </div>
            <form
              action="/admin/blogs/comments/delete/<%= comment.id %>?_method=DELETE"
              onsubmit="return confirm('Do you really want to delete this blog post');"
              method="post"
              class="d-inline"
            >
              <button type="submit" class="btn btn-danger" style="width: 200px">
                Delete
              </button>
            </form>
          </li>
          <% }) %>
        </ul>
      </div>
    </div>

    <%- include("../_partials/_adminfooter.ejs") %>
  </div>
</div>

<style>
  hover {
    color: #393e48;
  }

  .media-list {
    margin-top: 10px;
  }

  .media-list .media {
    padding: 5px 10px;
    border-bottom: 1px solid #eaeaea;
  }

  .media-list .media .media-object {
    width: 50px;
  }
</style>
